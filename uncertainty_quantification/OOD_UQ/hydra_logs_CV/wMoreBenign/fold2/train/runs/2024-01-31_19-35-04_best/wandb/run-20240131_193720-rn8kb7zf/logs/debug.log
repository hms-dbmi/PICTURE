2024-01-31 19:37:20,424 INFO    MainThread:20332 [wandb_setup.py:_flush():76] Current SDK version is 0.16.1
2024-01-31 19:37:20,425 INFO    MainThread:20332 [wandb_setup.py:_flush():76] Configure stats pid to 20332
2024-01-31 19:37:20,425 INFO    MainThread:20332 [wandb_setup.py:_flush():76] Loading settings from /home/shl968/.config/wandb/settings
2024-01-31 19:37:20,425 INFO    MainThread:20332 [wandb_setup.py:_flush():76] Loading settings from /n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/wandb/settings
2024-01-31 19:37:20,425 WARNING MainThread:20332 [wandb_setup.py:_flush():76] Unknown environment variable: WANDB_SERVICE
2024-01-31 19:37:20,425 INFO    MainThread:20332 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'entity': 'sylin186', 'project': 'uncertainty_vienna_CTransFeature_wMoreBenign_fold2', 'sweep_id': 'rrj5jp97', 'root_dir': '/n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main', 'run_id': 'rn8kb7zf', 'sweep_param_path': '/n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/wandb/sweep-rrj5jp97/config-rn8kb7zf.yaml'}
2024-01-31 19:37:20,425 INFO    MainThread:20332 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-01-31 19:37:20,425 INFO    MainThread:20332 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'src/train.py', 'program_abspath': '/n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/src/train.py', 'program': '/n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/src/train.py'}
2024-01-31 19:37:20,426 INFO    MainThread:20332 [wandb_init.py:_log_setup():524] Logging user logs to /n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/hydra_logs_CV/wMoreBenign/fold2/train/runs/2024-01-31_19-35-04/wandb/run-20240131_193720-rn8kb7zf/logs/debug.log
2024-01-31 19:37:20,426 INFO    MainThread:20332 [wandb_init.py:_log_setup():525] Logging internal logs to /n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/hydra_logs_CV/wMoreBenign/fold2/train/runs/2024-01-31_19-35-04/wandb/run-20240131_193720-rn8kb7zf/logs/debug-internal.log
2024-01-31 19:37:20,426 INFO    MainThread:20332 [wandb_init.py:init():564] calling init triggers
2024-01-31 19:37:20,426 INFO    MainThread:20332 [wandb_init.py:init():571] wandb.init called with sweep_config: {'model.certainty_budget': 'exp', 'model.entropy_weight': 1.7665575607568396e-05, 'model.latent_dim': 4, 'model.optimizer.lr': 2.831363591479448e-05, 'model.optimizer.weight_decay': 0.00337152123891442}
config: {}
2024-01-31 19:37:20,426 INFO    MainThread:20332 [wandb_init.py:init():614] starting backend
2024-01-31 19:37:20,426 INFO    MainThread:20332 [wandb_init.py:init():618] setting up manager
2024-01-31 19:37:20,438 INFO    MainThread:20332 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-01-31 19:37:20,444 INFO    MainThread:20332 [wandb_init.py:init():624] backend started and connected
2024-01-31 19:37:20,463 INFO    MainThread:20332 [wandb_run.py:_config_callback():1342] config_cb None None {'model.certainty_budget': 'exp', 'model.entropy_weight': 1.7665575607568396e-05, 'model.latent_dim': 4, 'model.optimizer.lr': 2.831363591479448e-05, 'model.optimizer.weight_decay': 0.00337152123891442}
2024-01-31 19:37:20,464 INFO    MainThread:20332 [wandb_init.py:init():716] updated telemetry
2024-01-31 19:37:20,465 INFO    MainThread:20332 [wandb_init.py:init():749] communicating run to backend with 90.0 second timeout
2024-01-31 19:37:20,830 INFO    MainThread:20332 [wandb_init.py:init():792] run resumed
2024-01-31 19:37:20,864 INFO    MainThread:20332 [wandb_run.py:_on_init():2254] communicating current version
2024-01-31 19:37:20,939 INFO    MainThread:20332 [wandb_run.py:_on_init():2263] got version response upgrade_message: "wandb version 0.16.2 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-01-31 19:37:20,940 INFO    MainThread:20332 [wandb_init.py:init():800] starting run threads in backend
2024-01-31 19:37:20,993 INFO    MainThread:20332 [wandb_run.py:_console_start():2233] atexit reg
2024-01-31 19:37:20,994 INFO    MainThread:20332 [wandb_run.py:_redirect():2088] redirect: wrap_raw
2024-01-31 19:37:20,994 INFO    MainThread:20332 [wandb_run.py:_redirect():2153] Wrapping output streams.
2024-01-31 19:37:20,994 INFO    MainThread:20332 [wandb_run.py:_redirect():2178] Redirects installed.
2024-01-31 19:37:20,995 INFO    MainThread:20332 [wandb_init.py:init():841] run started, returning control to user process
2024-01-31 19:37:21,022 INFO    MainThread:20332 [wandb_run.py:_config_callback():1342] config_cb None None {'model/_target_': 'src.models.uncertainty_module.UncertaintyModuleCTransFeatures', 'model/optimizer/_target_': 'torch.optim.AdamW', 'model/optimizer/_partial_': True, 'model/optimizer/lr': 2.831363591479448e-05, 'model/optimizer/weight_decay': 0.00337152123891442, 'model/latent_dim': 4, 'model/radial_flow_layers': 2, 'model/entropy_weight': 1.7665575607568396e-05, 'model/flow_type': 'MAF', 'model/certainty_budget': 'exp', 'model/locked_encoder': True, 'model/extra_ood': True, 'model/seed': 2, 'model/params/total': 3463, 'model/params/trainable': 3463, 'model/params/non_trainable': 0, 'datamodule/_target_': 'src.datamodules.vienna_feature_datamodule.ViennaFeatureDataModule', 'datamodule/batch_size': 1000, 'datamodule/train_val_test_split': [0.5, 0.25, 0.25], 'datamodule/num_workers': 4, 'datamodule/pin_memory': True, 'datamodule/class_balancing': True, 'trainer/_target_': 'pytorch_lightning.Trainer', 'trainer/default_root_dir': '/n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/hydra_logs_CV/wMoreBenign/fold2/train/runs/2024-01-31_19-35-04', 'trainer/min_epochs': 10, 'trainer/max_epochs': 20, 'trainer/accelerator': 'cpu', 'trainer/devices': 1, 'trainer/precision': 32, 'trainer/deterministic': False, 'trainer/check_val_every_n_epoch': 1, 'callbacks/model_checkpoint': 'val/epistemic_AUROC_MacroAvg', 'callbacks/early_stopping/_target_': 'pytorch_lightning.callbacks.EarlyStopping', 'callbacks/early_stopping/monitor': 'val/acc', 'callbacks/early_stopping/min_delta': 0.0, 'callbacks/early_stopping/patience': 100, 'callbacks/early_stopping/verbose': False, 'callbacks/early_stopping/mode': 'max', 'callbacks/early_stopping/strict': True, 'callbacks/early_stopping/check_finite': True, 'callbacks/early_stopping/stopping_threshold': 'None', 'callbacks/early_stopping/divergence_threshold': 'None', 'callbacks/early_stopping/check_on_train_epoch_end': 'None', 'callbacks/model_summary/_target_': 'pytorch_lightning.callbacks.RichModelSummary', 'callbacks/model_summary/max_depth': -1, 'callbacks/rich_progress_bar/_target_': 'pytorch_lightning.callbacks.RichProgressBar', 'extras/ignore_warnings': False, 'extras/enforce_tags': True, 'extras/print_config': True, 'task_name': 'train', 'tags': ['uncertainty', 'ivygap'], 'ckpt_path': 'None', 'seed': 2}
2024-01-31 20:15:51,960 INFO    MainThread:20332 [wandb_run.py:_finish():1962] finishing run sylin186/uncertainty_vienna_CTransFeature_wMoreBenign_fold2/rn8kb7zf
2024-01-31 20:15:51,960 INFO    MainThread:20332 [wandb_run.py:_atexit_cleanup():2202] got exitcode: 0
2024-01-31 20:15:51,961 INFO    MainThread:20332 [wandb_run.py:_restore():2185] restore
2024-01-31 20:15:51,961 INFO    MainThread:20332 [wandb_run.py:_restore():2191] restore done
2024-01-31 20:15:57,046 INFO    MainThread:20332 [wandb_run.py:_footer_history_summary_info():3837] rendering history
2024-01-31 20:15:57,050 INFO    MainThread:20332 [wandb_run.py:_footer_history_summary_info():3869] rendering summary
2024-01-31 20:15:57,064 INFO    MainThread:20332 [wandb_run.py:_footer_sync_info():3796] logging synced files
