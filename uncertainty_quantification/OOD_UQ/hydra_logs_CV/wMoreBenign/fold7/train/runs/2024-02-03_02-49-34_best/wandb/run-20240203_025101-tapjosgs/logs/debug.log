2024-02-03 02:51:01,484 INFO    MainThread:2027 [wandb_setup.py:_flush():76] Current SDK version is 0.16.1
2024-02-03 02:51:01,485 INFO    MainThread:2027 [wandb_setup.py:_flush():76] Configure stats pid to 2027
2024-02-03 02:51:01,486 INFO    MainThread:2027 [wandb_setup.py:_flush():76] Loading settings from /home/shl968/.config/wandb/settings
2024-02-03 02:51:01,486 INFO    MainThread:2027 [wandb_setup.py:_flush():76] Loading settings from /n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/wandb/settings
2024-02-03 02:51:01,486 INFO    MainThread:2027 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'entity': 'sylin186', 'project': 'uncertainty_vienna_CTransFeature_wMoreBenign_fold7', 'sweep_id': 'ejl0999g', 'root_dir': '/n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main', 'run_id': 'tapjosgs', 'sweep_param_path': '/n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/wandb/sweep-ejl0999g/config-tapjosgs.yaml'}
2024-02-03 02:51:01,486 INFO    MainThread:2027 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-02-03 02:51:01,486 INFO    MainThread:2027 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'src/train.py', 'program_abspath': '/n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/src/train.py', 'program': '/n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/src/train.py'}
2024-02-03 02:51:01,486 INFO    MainThread:2027 [wandb_init.py:_log_setup():524] Logging user logs to /n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/hydra_logs_CV/wMoreBenign/fold7/train/runs/2024-02-03_02-49-34/wandb/run-20240203_025101-tapjosgs/logs/debug.log
2024-02-03 02:51:01,486 INFO    MainThread:2027 [wandb_init.py:_log_setup():525] Logging internal logs to /n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/hydra_logs_CV/wMoreBenign/fold7/train/runs/2024-02-03_02-49-34/wandb/run-20240203_025101-tapjosgs/logs/debug-internal.log
2024-02-03 02:51:01,486 INFO    MainThread:2027 [wandb_init.py:init():564] calling init triggers
2024-02-03 02:51:01,486 INFO    MainThread:2027 [wandb_init.py:init():571] wandb.init called with sweep_config: {'model.certainty_budget': 'exp-half', 'model.entropy_weight': 1.2958746744780906e-08, 'model.latent_dim': 4, 'model.optimizer.lr': 2.032359836843273e-05, 'model.optimizer.weight_decay': 0.018869043265693337}
config: {}
2024-02-03 02:51:01,486 INFO    MainThread:2027 [wandb_init.py:init():614] starting backend
2024-02-03 02:51:01,487 INFO    MainThread:2027 [wandb_init.py:init():618] setting up manager
2024-02-03 02:51:01,500 INFO    MainThread:2027 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-02-03 02:51:01,503 INFO    MainThread:2027 [wandb_init.py:init():624] backend started and connected
2024-02-03 02:51:01,524 INFO    MainThread:2027 [wandb_run.py:_config_callback():1342] config_cb None None {'model.certainty_budget': 'exp-half', 'model.entropy_weight': 1.2958746744780906e-08, 'model.latent_dim': 4, 'model.optimizer.lr': 2.032359836843273e-05, 'model.optimizer.weight_decay': 0.018869043265693337}
2024-02-03 02:51:01,525 INFO    MainThread:2027 [wandb_init.py:init():716] updated telemetry
2024-02-03 02:51:01,526 INFO    MainThread:2027 [wandb_init.py:init():749] communicating run to backend with 90.0 second timeout
2024-02-03 02:51:01,924 INFO    MainThread:2027 [wandb_init.py:init():792] run resumed
2024-02-03 02:51:01,957 INFO    MainThread:2027 [wandb_run.py:_on_init():2254] communicating current version
2024-02-03 02:51:02,028 INFO    MainThread:2027 [wandb_run.py:_on_init():2263] got version response upgrade_message: "wandb version 0.16.2 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-02-03 02:51:02,028 INFO    MainThread:2027 [wandb_init.py:init():800] starting run threads in backend
2024-02-03 02:51:02,085 INFO    MainThread:2027 [wandb_run.py:_console_start():2233] atexit reg
2024-02-03 02:51:02,085 INFO    MainThread:2027 [wandb_run.py:_redirect():2088] redirect: wrap_raw
2024-02-03 02:51:02,085 INFO    MainThread:2027 [wandb_run.py:_redirect():2153] Wrapping output streams.
2024-02-03 02:51:02,086 INFO    MainThread:2027 [wandb_run.py:_redirect():2178] Redirects installed.
2024-02-03 02:51:02,087 INFO    MainThread:2027 [wandb_init.py:init():841] run started, returning control to user process
2024-02-03 02:51:02,102 INFO    MainThread:2027 [wandb_run.py:_config_callback():1342] config_cb None None {'model/_target_': 'src.models.uncertainty_module.UncertaintyModuleCTransFeatures', 'model/optimizer/_target_': 'torch.optim.AdamW', 'model/optimizer/_partial_': True, 'model/optimizer/lr': 2.032359836843273e-05, 'model/optimizer/weight_decay': 0.018869043265693337, 'model/latent_dim': 4, 'model/radial_flow_layers': 2, 'model/entropy_weight': 1.2958746744780906e-08, 'model/flow_type': 'MAF', 'model/certainty_budget': 'exp-half', 'model/locked_encoder': True, 'model/extra_ood': True, 'model/cancer_ood': True, 'model/seed': 7, 'model/params/total': 3463, 'model/params/trainable': 3463, 'model/params/non_trainable': 0, 'datamodule/_target_': 'src.datamodules.vienna_feature_datamodule.ViennaFeatureDataModule', 'datamodule/batch_size': 1000, 'datamodule/train_val_test_split': [0.5, 0.25, 0.25], 'datamodule/num_workers': 4, 'datamodule/pin_memory': True, 'datamodule/class_balancing': False, 'trainer/_target_': 'pytorch_lightning.Trainer', 'trainer/default_root_dir': '/n/data2/hms/dbmi/kyu/lab/shl968/pathology_uncertainty-main/hydra_logs_CV/wMoreBenign/fold7/train/runs/2024-02-03_02-49-34', 'trainer/min_epochs': 10, 'trainer/max_epochs': 20, 'trainer/accelerator': 'cpu', 'trainer/devices': 1, 'trainer/precision': 32, 'trainer/deterministic': False, 'trainer/check_val_every_n_epoch': 1, 'callbacks/model_checkpoint': 'val/epistemic_confidence_auc_roc', 'callbacks/early_stopping/_target_': 'pytorch_lightning.callbacks.EarlyStopping', 'callbacks/early_stopping/monitor': 'val/acc', 'callbacks/early_stopping/min_delta': 0.0, 'callbacks/early_stopping/patience': 100, 'callbacks/early_stopping/verbose': False, 'callbacks/early_stopping/mode': 'max', 'callbacks/early_stopping/strict': True, 'callbacks/early_stopping/check_finite': True, 'callbacks/early_stopping/stopping_threshold': 'None', 'callbacks/early_stopping/divergence_threshold': 'None', 'callbacks/early_stopping/check_on_train_epoch_end': 'None', 'callbacks/model_summary/_target_': 'pytorch_lightning.callbacks.RichModelSummary', 'callbacks/model_summary/max_depth': -1, 'callbacks/rich_progress_bar/_target_': 'pytorch_lightning.callbacks.RichProgressBar', 'extras/ignore_warnings': False, 'extras/enforce_tags': True, 'extras/print_config': True, 'task_name': 'train', 'tags': ['uncertainty', 'ivygap'], 'ckpt_path': 'None', 'seed': 7}
2024-02-03 04:41:42,281 INFO    MainThread:2027 [wandb_run.py:_finish():1962] finishing run sylin186/uncertainty_vienna_CTransFeature_wMoreBenign_fold7/tapjosgs
2024-02-03 04:41:42,282 INFO    MainThread:2027 [wandb_run.py:_atexit_cleanup():2202] got exitcode: 0
2024-02-03 04:41:42,283 INFO    MainThread:2027 [wandb_run.py:_restore():2185] restore
2024-02-03 04:41:42,283 INFO    MainThread:2027 [wandb_run.py:_restore():2191] restore done
2024-02-03 04:41:46,765 INFO    MainThread:2027 [wandb_run.py:_footer_history_summary_info():3837] rendering history
2024-02-03 04:41:46,768 INFO    MainThread:2027 [wandb_run.py:_footer_history_summary_info():3869] rendering summary
2024-02-03 04:41:46,778 INFO    MainThread:2027 [wandb_run.py:_footer_sync_info():3796] logging synced files
